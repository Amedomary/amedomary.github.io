define(["jquery"],function(o){function e(){s.hasClass("open")&&(p.removeClass("no-scroll no-touch windows"),s.removeClass("open"),s.fadeOut(300))}function n(o,e){var n=document,p=n.body,s=n.querySelector(e),t="client"+o;return o="scroll"+o,/CSS/.test(n.compatMode)?s[t]<s[o]:p[t]<p[o]}var p=o(".b-page-wrapper"),s=o(".b-popup"),t=o(".b-popup__content"),a=o(".js-open-popup"),u=o(".js-close-popup"),c=navigator.userAgent.toLowerCase().indexOf("windows")!==-1;a.on("click",function(){var e=o(".b-popup[data-popup='"+o(this).attr("data-popup")+"']");e.length>0&&(c&&n("Height",".b-page-wrapper")&&p.addClass("windows"),s.removeClass("open"),s.fadeOut(300),p.addClass("no-scroll no-touch"),e.addClass("open"),e.css("display","flex").hide().fadeIn(300))}),u.on("click",function(){e(),o(".js-menu-in-popup-back").length&&o(".js-menu-in-popup-back").trigger("click")}),o(document).on("keydown",function(o){27===o.keyCode&&e()}),o(document).mouseup(function(o){s.hasClass("open")&&(t.is(o.target)||0!==t.has(o.target).length||e())})});